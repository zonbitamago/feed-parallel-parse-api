# Feature Specification: 記事表示時のローディング表示抑制

**Feature Branch**: `018-fix-loading-display`
**Created**: 2025-11-25
**Status**: Draft
**Input**: User description: "記事表示時のローディング表示抑制：自動更新（ポーリング）時にローディングアイコンが表示されて既存の記事が読めなくなる問題を修正する。記事が0件でローディング中の場合のみローディングアイコンを表示し、記事が1件以上ある場合はローディング中でも記事一覧を表示し続ける。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 記事閲覧中のポーリング継続表示 (Priority: P1)

ユーザーが記事一覧を閲覧している最中に自動更新（ポーリング）が実行されても、既存の記事一覧が表示され続け、中断なく記事を読み続けることができる。

**Why this priority**: ユーザー体験の根幹に関わる問題。記事を読んでいる最中にローディング表示で中断されることは、ユーザーのフラストレーションを直接引き起こす最優先で解決すべき課題。

**Independent Test**: フィードを購読して記事が表示された状態で、ポーリングが発生しても記事一覧が継続表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** 記事が1件以上表示されている状態, **When** 自動更新（ポーリング）が開始される, **Then** 記事一覧が表示され続け、ローディングアイコンは表示されない
2. **Given** 記事が1件以上表示されている状態, **When** 自動更新（ポーリング）が完了する, **Then** 記事一覧は表示されたまま、新着記事通知バナーが表示される
3. **Given** 記事が1件以上表示されている状態, **When** ユーザーが「更新」ボタンを押す, **Then** 記事一覧が表示され続け、ローディングアイコンは表示されない

---

### User Story 2 - 初回読み込み時のローディング表示 (Priority: P1)

ユーザーがフィードを初めて追加した時、記事がまだ存在しない状態ではローディングアイコンが表示され、読み込み中であることが分かる。

**Why this priority**: ユーザーに処理中であることを適切にフィードバックすることは、ユーザー体験の基本であり、記事継続表示と同等に重要。

**Independent Test**: 新規フィードを追加して、記事取得完了までローディング表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** 記事が0件の状態（フィード未購読または初回読み込み中）, **When** フィードの取得処理が開始される, **Then** ローディングアイコンが表示される
2. **Given** ローディングアイコンが表示されている状態, **When** フィード取得が完了して記事が表示される, **Then** ローディングアイコンが消え、記事一覧が表示される

---

### Edge Cases

- 全フィードを削除して記事が0件になった直後に再購読した場合 → ローディングアイコンが表示される
- ポーリング中にユーザーが手動更新ボタンを押した場合 → 記事一覧は表示され続ける
- 取得エラーで記事が0件のままの場合 → エラーメッセージが表示される（既存動作を維持）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは、記事が0件かつ読み込み中の場合のみローディングアイコンを表示しなければならない
- **FR-002**: システムは、記事が1件以上存在する場合、読み込み中でも記事一覧を表示し続けなければならない
- **FR-003**: システムは、ポーリング（自動更新）中も手動更新中も同じ表示ルールを適用しなければならない
- **FR-004**: システムは、読み込み完了後は従来通り記事一覧または新着通知を表示しなければならない

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 記事が表示されている状態でポーリングが発生した場合、100%の確率で記事一覧が継続表示される
- **SC-002**: 記事が0件の状態で読み込みが開始された場合、100%の確率でローディングアイコンが表示される
- **SC-003**: ユーザーが記事を閲覧中にポーリングによる表示中断が0回になる
- **SC-004**: 手動更新時も同様に、記事がある場合は表示が中断されない

## Assumptions

- 既存のポーリング機能（10分間隔の自動更新）は正常に動作している
- 新着記事通知バナー機能は影響を受けない
- 記事の状態（articles配列）は信頼できるデータソースである
