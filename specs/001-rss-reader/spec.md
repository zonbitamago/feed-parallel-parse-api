# 機能仕様書: RSSリーダーアプリケーション

**フィーチャーブランチ**: `001-rss-reader`
**作成日**: 2025-10-27
**ステータス**: ドラフト
**入力**: ユーザー説明: "現在のAPIを利用した RSSリーダーを作成したい"

## 明確化 *(Clarifications)*

### セッション 2025-10-27

- Q: 初回表示時のデフォルト動作（購読フィードが0件の場合） → A: ウェルカム画面とフィード追加フォームを中央に表示
- Q: 記事表示の最大件数制限 → A: 最新50件を表示し、仮想スクロールで追加読み込み
- Q: 無効なURLを入力した場合の即時フィードバック → A: リアルタイム検証（入力中に無効なURLにエラー表示）
- Q: 検索機能の動作タイミング → A: リアルタイム検索（入力中に即座に結果が更新される）
- Q: 記事の公開日が取得できない場合の表示順序 → A: フィード内の記事順序を維持し、最後尾に配置

## ユーザーシナリオ & テスト *(必須)*

### ユーザーストーリー 1 - 統合RSS記事フィードの閲覧 (優先度: P1)

ユーザーは、複数のウェブサイトを訪問することなく、お気に入りのRSSフィードからの記事を1つの統一されたビューで読みたいと考えています。複数のRSSフィードURLを追加して、すべての記事を公開日順に表示できます。

**この優先度の理由**: これがRSSリーダーのコアバリュープロポジションです - 複数のソースからのコンテンツを1つの便利なインターフェースに集約します。これがなければ、アプリケーションには目的がありません。

**独立したテスト**: 複数のRSSフィードURLを提供し、すべてのフィードからの記事が1つの時系列ビューに表示されることを確認することで完全にテストできます。

**受け入れシナリオ**:

1. **前提条件** ユーザーが3つのRSSフィードURLを持っている、**実行** これらのURLをリーダーに入力する、**期待結果** 3つすべてのフィードからの記事が時系列順に表示される
2. **前提条件** ユーザーがフィードURLを送信した、**実行** フィードが読み込まれる、**期待結果** 各記事にタイトル、公開日、要約、ソースフィード名が表示される
3. **前提条件** ユーザーが記事リストを見ている、**実行** 記事タイトルをクリックする、**期待結果** 出版社のウェブサイトの元記事に移動する

---

### ユーザーストーリー 2 - RSSフィード購読の管理 (優先度: P2)

ユーザーは、新しいフィードを追加したり、もう購読していないフィードを削除したり、購読しているすべてのフィードのリストを表示したりして、RSSフィード購読を整理したいと考えています。

**この優先度の理由**: フィード管理は長期的な使用には不可欠ですが、ユーザーは最初に手動で入力したURLで基本機能をテストできます。

**独立したテスト**: フィードを追加し、それらが永続化されることを確認し、フィードを削除し、変更がセッション間で永続化されることを確認することでテストできます。

**受け入れシナリオ**:

1. **前提条件** ユーザーがフィード管理ページにいる、**実行** 新しいRSSフィードURLを入力して「追加」をクリックする、**期待結果** フィードが購読リストに表示される
2. **前提条件** ユーザーが購読フィードを持っている、**実行** フィードの「削除」をクリックする、**期待結果** そのフィードが購読リストから削除され、その記事も表示されなくなる
3. **前提条件** ユーザーが複数の購読フィードを持っている、**実行** 購読リストを表示する、**期待結果** フィードのタイトル、URL、各フィードからの記事数が表示される

---

### ユーザーストーリー 3 - 記事のフィルタリングと検索 (優先度: P3)

多くのRSSフィードを持つユーザーは、何百もの記事をスクロールするのではなく、キーワードで検索したり、ソースフィードでフィルタリングしたりして、特定の記事を素早く見つけたいと考えています。

**この優先度の理由**: これはパワーユーザーの使いやすさを向上させますが、MVPには必須ではありません。ユーザーは最初は手動で記事をスクロールできます。

**独立したテスト**: 検索用語を入力し、一致する記事のみが表示されることを確認することでテストできます。

**受け入れシナリオ**:

1. **前提条件** ユーザーが複数のフィードから記事を読み込んでいる、**実行** 検索ボックスにキーワードを入力する、**期待結果** タイトルまたは要約にそのキーワードを含む記事のみが表示される
2. **前提条件** ユーザーが複数の購読フィードを持っている、**実行** フィルタードロップダウンから特定のフィードを選択する、**期待結果** そのフィードからの記事のみが表示される
3. **前提条件** ユーザーがフィルタを適用している、**実行** フィルタをクリアする、**期待結果** すべての記事が再び表示される

---

### ユーザーストーリー 4 - フィードコンテンツの更新 (優先度: P2)

ユーザーは、ページ全体をリロードしたり、URLを再入力したりせずに、フィードから最新の記事を見たいと考えています。

**この優先度の理由**: コンテンツの鮮度はRSSリーダーにとって重要ですが、MVPでは手動ページリロードで対応可能です。

**独立したテスト**: 更新をクリックし、API呼び出しが完了するまで待ち、新しい記事が表示されることを確認することでテストできます。

**受け入れシナリオ**:

1. **前提条件** ユーザーがフィード記事を表示している、**実行** 「更新」ボタンをクリックする、**期待結果** アプリケーションがすべての購読フィードから最新のコンテンツを取得する
2. **前提条件** 前回の更新以降に新しい記事が公開されている、**実行** 更新が完了する、**期待結果** 新しい記事がリストの上部に表示される
3. **前提条件** フィード更新が進行中である、**実行** 操作が実行されている、**期待結果** ユーザーにローディングインジケーターが表示される

---

### エッジケース

- フィードURLが無効または到達不可能な場合はどうなるか？（APIはエラー情報を返す - 明確なエラーメッセージをユーザーに表示）
- システムは読み込みに10秒以上かかるフィードをどのように処理するか？（APIには10秒のタイムアウトがある - 影響を受けたフィードのタイムアウトメッセージを表示）
- フィードに記事が含まれていない場合はどうなるか？（そのフィードに「記事がありません」というメッセージを表示）
- 記事の公開日が取得できない場合はどうなるか？（フィード内の元の順序を維持し、公開日がある記事の後に表示）
- システムはフィード間で重複する記事をどのように処理するか？（すべてのインスタンスを表示 - 重複排除はMVPのスコープ外）
- フィードのXMLが不正な形式の場合はどうなるか？（APIは解析エラーを返す - ユーザーにエラーメッセージを表示）
- ユーザーが101以上のフィードを購読した場合はどうなるか？（APIは最大100URLをサポート - 検証エラーを表示し、購読を100に制限）
- システムは非常に長い記事要約を持つフィードをどのように処理するか？（要約を300文字で切り詰め、「...」を表示する）
- ユーザーが購読フィードを持っていない場合はどうなるか？（ウェルカム画面とフィード追加フォームを中央に表示）

## 要件 *(必須)*

### 機能要件

- **FR-001**: アプリケーションは、集約のために1つ以上のRSSフィードURLをユーザーが送信できるようにしなければならない
- **FR-002**: アプリケーションは、送信されたURLで既存のparse API (POST /api/parse) を呼び出さなければならない
- **FR-003**: アプリケーションは、正常に解析されたすべてのフィードからの記事を統一されたリストで表示しなければならない
- **FR-004**: アプリケーションは、各記事のタイトル、公開日、要約、ソースフィード名、元記事へのリンクを表示しなければならない
- **FR-005**: アプリケーションは、すべてのフィード間で記事を公開日順（最新順）にソートしなければならない。公開日が取得できない記事は、フィード内の元の順序を維持し、公開日がある記事の後（最後尾）に配置しなければならない
- **FR-006**: アプリケーションは、APIエラーレスポンス（例：到達不可能なURL、解析失敗）をユーザーフレンドリーな方法で処理および表示しなければならない
- **FR-007**: アプリケーションは、ユーザーの購読フィードURLをブラウザのlocalStorageに永続化しなければならない
- **FR-008**: アプリケーションは、フィードURL入力時にリアルタイムで検証し、無効なURL形式の場合は即座にエラーメッセージを表示しなければならない
- **FR-009**: アプリケーションは、フィード購読を最大100URLに制限しなければならない（API制約）
- **FR-010**: アプリケーションは、購読からフィードを削除する方法を提供しなければならない
- **FR-011**: アプリケーションは、購読フィードから最新記事を取得する更新メカニズムを提供しなければならない
- **FR-012**: アプリケーションは、API呼び出し中にローディングインジケーターを表示しなければならない
- **FR-013**: アプリケーションは、記事タイトルをクリック可能なリンクにして、元記事を新しいブラウザタブで開くようにしなければならない
- **FR-014**: ユーザーは、各フィードのステータス（正常に読み込まれた、失敗、読み込み中）を確認できなければならない
- **FR-015**: アプリケーションは、キーワードで記事をフィルタリングする検索機能を提供し、入力中にリアルタイムで検索結果を更新しなければならない
- **FR-016**: アプリケーションは、購読フィードが0件の場合、ウェルカム画面とフィード追加フォームを中央に表示しなければならない
- **FR-017**: アプリケーションは、初期表示時に最新50件の記事を表示し、ユーザーがスクロールすると仮想スクロールで追加の記事を動的に読み込まなければならない

### 主要エンティティ

- **フィード購読**: ユーザーの保存されたRSSフィードを表し、フィードURL、フィードタイトル（APIレスポンスから）、購読タイムスタンプを含む
- **記事**: RSSフィードから解析された記事を表し、タイトル、リンク、公開日、要約、ソースフィード情報（APIレスポンスから）を含む
- **フィードエラー**: 失敗したフィード取得/解析操作を表し、URLとエラーメッセージ（APIエラーレスポンスから）を含む

## 成功基準 *(必須)*

### 測定可能な成果

- **SC-001**: ユーザーは、最大100のRSSフィードからの記事を単一の統一されたインターフェースで表示できる
- **SC-002**: ユーザーは、10秒以内にフィード購読を追加または削除できる
- **SC-003**: アプリケーションは、リクエストから10秒以内に集約されたフィードコンテンツを表示する（APIの10秒保証を活用）
- **SC-004**: 有効なRSSフィードURLの95%が正常に解析され、表示される（APIの信頼性に依存）
- **SC-005**: ユーザーは、5秒以内にキーワード検索を使用して特定の記事を見つけることができる
- **SC-006**: フィード購読は、ブラウザセッションとページリロード間で永続化される
- **SC-007**: エラーメッセージは、APIレスポンスから1秒以内に失敗したフィードに対して表示される
- **SC-008**: ユーザーは、「フィード追加 → 記事表示 → 記事クリック」のワークフローを30秒以内に完了できる

## 依存関係と前提条件 *(必須)*

### 依存関係

- <https://feed-parallel-parse-api.vercel.app/> で実行されている既存のfeed-parallel-parse-api
- APIエンドポイント POST /api/parse、リクエスト形式 `{"urls": ["..."]}` およびレスポンス形式 `{"feeds": [...], "errors": [...]}`
- APIパフォーマンス保証: 最大100URLに対して最大10秒のレスポンスタイム
- RSS 1.0 (RDF)、RSS 2.0、Atom 1.0形式のAPIサポート

### 前提条件

- ユーザーは外部RSSフィードにアクセスするためのインターネット接続を持っている
- ユーザーが提供するRSSフィードURLは公開アクセス可能である（認証不要）
- 記事の要約は、フィードコンテンツからそのまま表示される（基本的なHTMLエスケープを超える追加処理やサニタイゼーションは行わない）
- ユーザーのブラウザは最新のWeb標準をサポートしている（ES6+、Fetch API、localStorage）
- フィードコンテンツの更新はリアルタイムではない - ユーザーは最新記事を取得するために手動で更新する必要がある
- MVPではユーザー認証は不要 - すべてのフィード購読はブラウザ/デバイスごとに保存される
- MVPではフィード間の記事重複排除は不要
- MVPでは記事の既読/未読追跡は不要
- MVPではオフライン読み取り機能は不要
- モバイルレスポンシブデザインは望ましいがMVPでは厳密には必須ではない
- 記事リンクは新しいブラウザタブで開く（外部リンクの標準動作）
- 記事の要約は、300文字を超える場合は300文字で切り詰められ、「...」インジケーターが付く

## スコープ境界 *(必須)*

### スコープ内

- Webベースのリーダーインターフェース（ブラウザアプリケーション）
- フィード購読管理（追加、削除、リスト）
- 複数のフィードからの記事集約と表示
- 記事の検索とフィルタ機能
- エラー処理とユーザーフレンドリーなエラーメッセージ
- フィード更新メカニズム
- 基本的なURL検証

### スコープ外

- ユーザー認証とマルチユーザーサポート
- サーバーサイドフィード購読ストレージ（MVPではブラウザストレージを使用）
- 記事の既読/未読追跡
- 記事のお気に入りまたはブックマーク
- オフライン読み取り機能
- フィードのカテゴリ化またはタグ付け
- 記事共有機能
- 新しい記事のプッシュ通知
- カスタムフィード更新間隔
- フィード検出または推奨機能
- 記事コンテンツ抽出またはリーダーモード
- 購読リストのエクスポート/インポート（OPML）
- フィードメタデータの編集（カスタム名、説明）
- 記事へのコメントやソーシャル機能
