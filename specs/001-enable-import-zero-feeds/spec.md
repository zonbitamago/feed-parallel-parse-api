# Feature Specification: 購読フィード0件時のインポート機能有効化

**Feature Branch**: `001-enable-import-zero-feeds`
**Created**: 2025-11-04
**Status**: Draft
**Input**: User description: "購読フィード0件時にインポート機能を利用可能にする。現在は subscriptions.length > 0 の条件でインポート/エクスポートボタン全体が非表示になっているが、インポートボタンは0件時こそ必要（初期フィード登録のため）。エクスポートボタンは0件時に無効化（disabled）が妥当。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 初回利用時のフィードインポート (Priority: P1)

新規ユーザーまたは購読フィード0件の状態で、既存のフィードリスト（JSONファイル）をインポートして初期設定を行う。

**Why this priority**: 初回利用時にフィードを手動で1件ずつ登録するのは非効率であり、既存のフィードリストからインポートできることで、ユーザーは即座にアプリケーションを使い始めることができる。これは最も重要なユースケースである。

**Independent Test**: 購読フィード0件の状態でインポートボタンをクリックし、JSONファイルを選択することで、フィードリストが正常にインポートされることを確認できる。この機能単体で完結した価値を提供する。

**Acceptance Scenarios**:

1. **Given** 購読フィードが0件の状態、**When** インポートボタンをクリックしてJSONファイルを選択、**Then** フィードリストが正常にインポートされ、購読フィードリストに表示される
2. **Given** 購読フィードが0件の状態、**When** フィード管理セクションのリストを展開、**Then** インポートボタンが表示され、クリック可能な状態である
3. **Given** 購読フィードが0件の状態、**When** 無効なJSONファイルをインポート、**Then** エラーメッセージが表示され、フィードリストは変更されない

---

### User Story 2 - エクスポート機能の適切な無効化 (Priority: P2)

購読フィードが0件の状態で、エクスポートボタンは表示されるが無効化（disabled）され、ユーザーに視覚的フィードバックを提供する。

**Why this priority**: 0件の状態でエクスポートボタンを有効にしても意味がないため、適切に無効化することで、ユーザーの混乱を防ぎ、UIの一貫性を保つ。P1より優先度は低いが、ユーザー体験の向上に寄与する。

**Independent Test**: 購読フィード0件の状態でエクスポートボタンが無効化され、1件以上の状態では有効化されることを確認できる。視覚的フィードバック（スタイル変更）も確認可能。

**Acceptance Scenarios**:

1. **Given** 購読フィードが0件の状態、**When** フィード管理セクションのリストを展開、**Then** エクスポートボタンが無効化（disabled）され、視覚的に無効状態であることが分かる（透明度50%、カーソルがnot-allowed）
2. **Given** 購読フィードが1件以上の状態、**When** フィード管理セクションのリストを展開、**Then** エクスポートボタンが有効化され、クリック可能な状態である
3. **Given** 購読フィードが0件の状態でエクスポートボタンが無効、**When** 新しいフィードを追加して1件になる、**Then** エクスポートボタンが自動的に有効化される

---

### User Story 3 - アクセシビリティ対応 (Priority: P3)

スクリーンリーダーやキーボード操作を使用するユーザーが、インポート/エクスポート機能の状態を理解できる。

**Why this priority**: アクセシビリティはすべてのユーザーに対する基本的な配慮であり、WCAG 2.1準拠を目指す上で重要。ただし、P1・P2の機能が実装されていれば、後から追加可能なため優先度はP3。

**Independent Test**: スクリーンリーダーでボタンの状態（有効/無効）が正しく読み上げられ、キーボード操作でボタンにフォーカスできることを確認できる。

**Acceptance Scenarios**:

1. **Given** 購読フィードが0件の状態、**When** スクリーンリーダーでエクスポートボタンを読み上げ、**Then** 「エクスポート、無効」と読み上げられる（aria-disabled属性）
2. **Given** フィード管理セクション、**When** Tabキーでインポート/エクスポートボタンにフォーカス、**Then** 視覚的にフォーカスが表示され、Enterキーで操作可能
3. **Given** 購読フィードが1件以上の状態、**When** スクリーンリーダーでエクスポートボタンを読み上げ、**Then** 「エクスポート」と読み上げられる（無効状態ではない）

---

### Edge Cases

- **購読フィードが0件から1件に変わる瞬間**: エクスポートボタンが即座に有効化されるか？
- **インポート中にエラーが発生した場合**: エラーメッセージが表示され、フィードリストは変更されないか？
- **インポートファイルに0件のフィードが含まれる場合**: 正常に処理され、エラーにならないか？
- **リストが折りたたまれている状態**: ボタンは非表示のまま維持されるか？
- **インポート/エクスポートボタンが同時に表示される場合**: レイアウトが崩れないか？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは購読フィード0件の状態でもインポートボタンを表示し、クリック可能な状態に保つこと
- **FR-002**: システムは購読フィード0件の状態でエクスポートボタンを無効化（disabled）すること
- **FR-003**: システムは購読フィードが1件以上の状態ではエクスポートボタンを有効化すること
- **FR-004**: システムはエクスポートボタンが無効化されている場合、視覚的フィードバックを提供すること（透明度50%、カーソルnot-allowed）
- **FR-005**: システムはエクスポートボタンにaria-disabled属性を設定し、スクリーンリーダーで無効状態を通知すること
- **FR-006**: システムはフィード管理セクションのリストが展開されている場合のみ、インポート/エクスポートボタンを表示すること
- **FR-007**: システムは購読フィード数が0から1に変わった際、エクスポートボタンを即座に有効化すること
- **FR-008**: システムは購読フィード数が1から0に変わった際、エクスポートボタンを即座に無効化すること

### Key Entities

- **購読フィードリスト**: アプリケーションで管理されるフィードのコレクション。件数（0件以上）によってUI要素の状態が変化する。
- **インポートボタン**: JSONファイルからフィードリストをインポートするUI要素。常に有効（リスト展開時）。
- **エクスポートボタン**: フィードリストをJSONファイルにエクスポートするUI要素。購読フィード0件時は無効化。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 購読フィード0件の状態で、ユーザーがインポートボタンをクリックして、5秒以内にフィードリストをインポートできること
- **SC-002**: 購読フィード0件の状態で、エクスポートボタンが視覚的に無効化され、ユーザーが無効状態を即座に認識できること（透明度50%、カーソルnot-allowed）
- **SC-003**: スクリーンリーダーユーザーが、エクスポートボタンの無効状態を音声で確認できること（「エクスポート、無効」と読み上げ）
- **SC-004**: 購読フィード数が0件から1件に変わった際、1秒以内にエクスポートボタンが有効化されること
- **SC-005**: 既存の動作（リスト折りたたみ時のボタン非表示）が維持され、新機能によって既存機能が影響を受けないこと
